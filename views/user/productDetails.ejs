<%- include('./partial/head') %>
<style>
    .breadcrumb {
    background-color: #f8f9fa;
    padding: 0.75rem 1rem;
    margin-bottom: 1rem;
    border-radius: 0.25rem;
}

.breadcrumb a {
    color: #007bff;
    text-decoration: none;
    transition: color 0.2s;
}

.breadcrumb a:hover {
    color: #0056b3;
    text-decoration: underline;
}   
.stext-104 {
    display: block;
    margin-bottom: 0.5rem;
    color: #28a745; 
    font-weight: bold;
}


.flex-m.bor9 a:hover {
    color: #c82333;
    transform: scale(1.1);
}

.review {
    border-top: 1px solid #e9ecef;
    padding-top: 0.5rem;
    margin-top: 0.5rem;
    transition: background-color 0.3s;
}

.review:hover {
    background-color: #f8f9fa;
}

.review p {
    margin: 0;
    font-style: italic;
}

.btn-num-product-down,
.btn-num-product-up {
    cursor: pointer;
    transition: background-color 0.2s, color 0.2s;
}

.btn-num-product-down:hover,
.btn-num-product-up:hover {
    background-color: #007bff;
    color: white;
}

.flex-c-m.s-101 {
    transition: background-color 0.3s, transform 0.3s;
}

.flex-c-m.s-101:hover {
    background-color: #007bff;
    transform: scale(1.05);
}

</style>
<div class="container">
    <div class="row">
        <div class=" p-t-60 p-b-20">
            <div class="container">
                <div class="bg0 p-t-60 p-b-30 p-lr-15-lg how-pos3-parent">
                    <!-- Close Button -->
                    <button class="how-pos3 hov3 trans-04 js-hide-modal1">
                        <img src="/assets/images/icons/icon-close.png" alt="CLOSE">
                    </button>
                
                    <!-- Breadcrumbs -->
                    <nav aria-label="breadcrumb" class="p-b-20">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="/">Home</a></li>
                            <li class="breadcrumb-item"><a href="/products">Shop</a></li>
                            <li class="breadcrumb-item active" aria-current="page"><%= selectedProduct.title %></li>
                        </ol>
                    </nav>
                
                    <div class="row">
                        <div class="col-md-6 col-lg-7 p-b-30">
                            <div class="p-l-25 p-r-30 p-lr-0-lg">
                                <div class="wrap-slick3 flex-sb flex-w">
                                    <div class="wrap-slick3-dots"></div>
                                    <div class="wrap-slick3-arrows flex-sb-m flex-w"></div>
                                    <div class="slick3 gallery-lb">
                                        <!-- <div class="item-slick3" data-thumb="<%= selectedProduct.productimg[0] %>">
                                            <div class="wrap-pic-w pos-relative">
                                                
                                                <a class="flex-c-m size-108 how-pos1 bor0 fs-16 cl10 bg0 hov-btn3 trans-04 MagicZoom " href="<%= selectedProduct.productimg[0] %>">
                                                    <img src="<%= selectedProduct.productimg[0] %>" alt="IMG-PRODUCT">
                                                    <i class="fa fa-expand"></i>
                                                </a>
                                            </div>
                                        </div> -->
                                        <% if (selectedProduct && selectedProduct.productimg && selectedProduct.productimg.length > 0) { %>
                                            <% selectedProduct.productimg.forEach((image, index) => { %>
                                                <div class="item-slick3" data-thumb="<%= image %>">
                                                    <div class="wrap-pic-w pos-relative">
                                                        <a href="/<%=image%>"
                                                            class="MagicZoom"><img src="/<%=image%>"></a>
                                                    </div>
                                                </div>
                                            <% }); %>
                                        <% } %>
                                    </div>
                                </div>
                            </div>
                        </div>
                
                        <div class="col-md-6 col-lg-5 p-b-30">
                            <div class="p-r-50 p-t-5 p-lr-0-lg">
                                <h4 class="mtext-105 cl2 js-name-detail p-b-14">
                                    <%= selectedProduct.title %>
                                </h4>
                
                                <!-- Ratings -->
                                <div class="flex-w flex-m p-b-14">
                                    <span class="fs-18 cl11 p-r-10">
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star-half-o"></i>
                                    </span>
                                    <span class="mtext-106 cl2 p-l-10">
                                        (45 reviews)
                                    </span>
                                </div>
                
                                <span class="mtext-106 cl2">
                                    $<%= selectedProduct.price %>
                                </span>
                
                                <!-- Discount/Coupons -->
                                <div class="p-t-10">
                                    <span class="stext-104 cl4">
                                        <strong>10% OFF</strong> with code <strong>SUMMER21</strong>
                                    </span>
                                </div>
                
                                <!-- Product Description -->
                                <p class="stext-102 cl3 p-t-23">
                                    <%= selectedProduct.productdesc %>
                                </p>
                
                                <!-- Stock -->
                                <p class="stext-102 cl3 p-t-10 ">
                                    <% if (selectedProduct.stock> 0) { %>
                                     <p class="text-success">Instock</p>
                                     <% } else { %>
                                      <p class="text-secondary">Sold Out</p>
                                    <% } %>
                                </p>
                
                                <div class="p-t-33">
                                    <div class="flex-w flex-r-m p-b-10">
                                        <div class="size-204 flex-w flex-m respon6-next">
                                            <!-- <div class="wrap-num-product flex-w m-r-20 m-tb-10">
                                                <div class="btn-num-product-down cl8 hov-btn3 trans-04 flex-c-m">
                                                    <i class="fs-16 zmdi zmdi-minus"></i>
                                                </div>
                                                <input class="mtext-104 cl3 txt-center num-product" type="number" name="num-product" value="1">
                                                <div class="btn-num-product-up cl8 hov-btn3 trans-04 flex-c-m">
                                                    <i class="fs-16 zmdi zmdi-plus"></i>
                                                </div>
                                            </div> -->
                                            <% if (selectedProduct.stock > 0 && productAdded.length==0) { %>
                                                <button class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04" onclick="addToCart('<%= selectedProduct._id %>')">
                                                    Add to cart
                                                </button>
                                                <% } else if (productAdded && productAdded.length!==0) { %>
                                                    <a href="/cartPage"><button class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04">
                                                        View cart
                                                    </button></a>
                                            <% } else { %>
                                                <button class="flex-c-m stext-101 cl0 size-101 bor1 hov-btn1 p-lr-15 trans-04  btn btn-warning">
                                                    Out of stock
                                                </button>
                                            <% } %>
                                        </div>
                                    </div>
                                </div>
                
                                <!-- <div class="flex-w flex-m p-l-100 p-t-40 respon7">
                                    <div class="flex-m bor9 p-r-10 m-r-11">
                                        <a href="#" class="fs-24 cl3 hov-cl1 trans-04 lh-10 p-lr-5 p-tb-2 js-addwish-detail tooltip100" data-tooltip="Add to Wishlist">
                                            <i class="zmdi zmdi-favorite"></i>
                                        </a>
                                    </div>
                                </div> -->
                            </div>
                
                            <!-- Reviews -->
                            <div class="p-t-40">
                                <h5 class="mtext-105 cl2 p-b-14">Reviews</h5>
                                <div class="review p-t-10">
                                    <p class="stext-102 cl6">"Great product, highly recommend!" - John Doe</p>
                                </div>
                                <div class="review p-t-10">
                                    <p class="stext-102 cl6">"Quality could be better, but overall satisfied." - Jane Smith</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>     
                
                <div class="related-products">
                    <h5 class="mtext-105 cl2 p-b-14">Related Products</h5>
                    <div class="row">
                        <% relatedProducts.forEach(product => { %>
                            <div class="col-sm-6 col-md-4 col-lg-3 p-b-35">
                                <div class="block2">
                                    <div class="block2-pic hov-img0">
                                        <img style="height: 18rem;" src="<%= product.productimg[0] %>" alt="<%= product.title %>">
                                        <a href="/productDetails?id=<%= product._id %>" class="block2-btn flex-c-m stext-103 cl2 size-102 bg0 bor2 hov-btn1 p-lr-15 trans-04 ">
                                            View Details
                                        </a>
                                    </div>
                                    <div class="block2-txt flex-w flex-t p-t-14">
                                        <div class="block2-txt-child1 flex-col-l">
                                            <a href="/productDetails?id=<%= product._id %>" class="stext-104 cl4 hov-cl1 trans-04 js-name-b2 p-b-6 text-dark">
                                                <%= product.title %>
                                            </a>
                                            <span class="stext-105 cl3">
                                                $<%= product.price %>
                                            </span>
                                        </div>
                                        <div class="block2-txt-child2 flex-r p-t-3">
                                            <a href="#" class="btn-addwish-b2 dis-block pos-relative js-addwish-b2">
                                                <img class="icon-heart1 dis-block trans-04" src="/assets/images/icons/icon-heart-01.png" alt="ICON">
                                                <img class="icon-heart2 dis-block trans-04 ab-t-l" src="/assets/images/icons/icon-heart-02.png" alt="ICON">
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        <% }); %>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
</div>
<script>
async function addToCart(productId){
    try {   
        const response = await fetch(`/addtoCart/${productId}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            }
        });
        const result = await response.json();
        if (result.success) {
            Swal.fire({
                title: "Item has been added",
                text: "check your cart.",
                icon: "success",
                showConfirmButton: false
            });
            setTimeout(() => {
                location.reload()
            }, 1000);
        } else {
            Swal.fire({
                text: "Failed to add item to cart.",
                icon: "error"
            });
        }
    } catch (error) {
        console.error('There was an error!', error);
        Swal.fire({
            text: "There was an error adding the item to the cart.",
            icon: "error"
        });
    }
}

</script>
<%- include('./partial/footer') %>